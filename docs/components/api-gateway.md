# API Gateway

## Overview

This document describes the API Gateway component used to expose the
service HTTP API defined in the API Contract.

API Gateway acts as a **boundary component** between external clients
and the internal service implementation.

Its responsibility is limited to request routing, basic protocol
handling and integration with backend compute.

---

## Responsibilities

API Gateway is responsible for:

- Exposing the HTTP endpoints defined in the API Contract
- Handling HTTP request and response semantics
- Routing requests to the appropriate backend Lambda functions
- Enforcing basic request size limits

API Gateway is NOT responsible for:

- Business logic
- Event validation beyond basic protocol checks
- Idempotency enforcement
- Persistence or data access
- Authorization or authentication

---

## API Type

The service uses **Amazon API Gateway – HTTP API**.

### Rationale

HTTP APIs are selected because they:

- Provide low latency
- Have a simple cost and operational model
- Offer native integration with Lambda
- Are sufficient for the required request/response interaction patterns

Advanced API Gateway features such as request validation models,
usage plans or API keys are intentionally not used.

---

## API Structure

### Base Path

All endpoints are exposed under the root path:

/

The API Gateway does not introduce any additional path structure
beyond what is defined in the API Contract.

---

## Endpoints

API Gateway exposes the following routes, as defined in the API Contract:

- POST /events
- GET  /events/{event_id}

API Gateway does not alter request paths or payloads beyond
basic protocol handling.

---

## Integration Model

### Backend Integration

Each endpoint is integrated with a dedicated AWS Lambda function:

- POST /events → Ingestion Lambda
- GET  /events/{event_id} → Read Lambda

The integration uses **Lambda proxy integration**, allowing backend
functions to receive the full request context and return structured
HTTP responses.

---

### Request Handling

API Gateway forwards to Lambda:

- HTTP method
- Path parameters
- Query parameters
- Headers
- Raw JSON body

No transformation or enrichment is performed at the API Gateway layer.

---

### Response Handling

Lambda functions are responsible for:

- Determining response status codes
- Producing response bodies
- Returning error responses consistent with the API Contract

API Gateway forwards responses to clients without modification.

---

## Limits and Timeouts

### Request Size

API Gateway enforces a maximum request payload size of 256 KB.

Requests exceeding this limit are rejected at the boundary
before reaching backend Lambda functions.

---

### Timeout

- API Gateway timeout follows HTTP API defaults
- Lambda timeouts are configured independently

Timeouts are configured to avoid long-running requests
at the boundary layer.

---

## Error Handling

API Gateway distinguishes between:

- Client-side protocol errors (malformed HTTP requests)
- Backend errors returned by Lambda

All application-level errors are generated by backend Lambda
functions and returned according to the API Contract.

---

## Security Considerations

The API Gateway does not enforce authentication or authorization.

The service is intended for internal or controlled usage
within a trusted environment.

---

## Relationship to Other Components

- Invokes: Ingestion Lambda and Read Lambda
- Exposes: HTTP API defined by the API Contract
- Does not maintain state

API Gateway can be scaled independently of backend components.
